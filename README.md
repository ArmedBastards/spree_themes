VinsolSpreeThemes
==================

This extension allows the admin to upload new spree store themes from backend. This extension provides an interface where admin can manage all the themes by editing them, deleting old themes and publishing theme to store for the users.

Admin can even preview the theme after modifying it from the backend before publishing it to the users.


## Requirements

This extension currently supports Ruby 2.4, Rails 5 and Spree 3.2.


## Features

Some of the current functionalities are:-

1. Upload the theme
1. Preview the theme.
2. Publish the theme on spree store.
3. Download the theme.
4. Remove the uploaded theme.
5. Modify the uploaded / published theme.


## Installation

1. Add this extension to your Gemfile:
  ```ruby
  gem 'vinsol_spree_themes', github: '[your-github-handle]/vinsol_spree_themes'
  ```

2. Install the gem using Bundler:
  ```ruby
  bundle install
  ```

3. Copy & run migrations
  ```ruby
  bundle exec rails g vinsol_spree_themes:install
  ```

4. Restart your server
  ```ruby
  rails server
  ```


## Usage

After installing the extension, admin will see a tab `vinsol spree themes` on left sidebar of admin panel. Or you can visit the link

```
 http://localhost:3000/admin/themes
```

Then, admin uploads the new theme in zip file. Once uploaded, admin can preview the theme and also modify it accordingly through the editor.

Theme templates can be modified through the editor. Later theme can be published for the spree store users.

*Note:- Before publishing the theme, admin needs to compile it using the link provided with other options for all assets to load properly.*

Once the extension is installed, admin gets a spree store default theme uploaded on the system and is published for the store users.

Besides preview and publishing, admin can delete the uploaded theme or download it in zip format.


## Theme Structure

Theme file structure for the zip file to be uploaded:-

* Theme.zip
  * javascripts
  * stylesheets
  * images
  * views: These views will be the spree frontend view directory.
  * snapshot.png: This is the snapshot for the theme visible at backend.
  * meta_info.yml: This .yml file contains meta info of the theme.

*Note:- When uploading, files starting with '__' or '.' will be ignored*

Create a meta_info.yml file on the theme directory which contains the meta info of the theme. Format of the file should be following:-
 * name: Name of the theme
 * version: Version of the theme
 * authors: Authors of the theme

*Note:- Add new javascript files to javascripts directory and new stylesheet files to stylesheets directory. For adding js and css manifest files, file name should be script.manifest.js or style.manifest.css. If using sass, use style.manifest.scss files instead of .css.*


## Developers

If modifying the theme directly from the filesystem, follow these steps:-

1. Publish the theme which need to be updated/modified.

2. Update the theme assets, stylesheets, scripts and templates from the path. 
  ```
  public/vinsol_spree_themes/<theme_name>/
  ```

  or

  ```
  public/vinsol_spree_themes/current/
  ```

3. If application is running, reload the store page and you will see the changes on the browser.

4. Once all the changes are done and final theme is ready, run the following rake task to sync the updated files with the database.
  ```
  bundle exec rake db:sync_templates THEME_NAME=<theme_name>
  ```

*Note:- For manually uploading the theme, make sure you download the updatd theme and change the theme name (Theme name is the name of the zip file). Also make sure to update the meta info of the theme in the file `meta_info.yml` when the theme is updated.*


## Production Setup

1. Set the following configuration for production environment in environment file `production.rb`:
  ```ruby
  config.assets.compile = true
  config.public_file_server.enabled = true
  ```

2. Add the following path to the shared linked dir in deploy.rb file.
  ```
  set :linked_dirs, %w( public/vinsol_spree_themes )
  ```


## Testing

First bundle your dependencies, then run `rake`. `rake` will default to building the dummy app if it does not exist, then it will run specs. The dummy app can be regenerated by using `rake test_app`.

```shell
bundle
bundle exec rake
```

When testing your applications integration with this extension you may use it's factories.
Simply add this require statement to your spec_helper:

```ruby
require 'vinsol_spree_themes/factories'
```


## Contributing

If you'd like to contribute, please take a look at the
[instructions](CONTRIBUTING.md) for installing dependencies and crafting a good
pull request.

Copyright (c) 2017 [name of extension creator], released under the New BSD License
