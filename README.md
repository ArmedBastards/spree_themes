VinsolSpreeThemes
==================

This extension allows the admin to modify, upload new frontend themes from backend. It also provides admin to create new/edit templates to existing themes.


## Installation

This extension currently supports Rails 5 and Spree 3.2

1. Add this extension to your Gemfile:
  ```ruby
  gem 'vinsol_spree_themes', github: '[your-github-handle]/vinsol_spree_themes'
  ```

2. Install the gem using Bundler:
  ```ruby
  bundle install
  ```

3. Copy & run migrations
  ```ruby
  bundle exec rails g vinsol_spree_themes:install
  ```

4. Restart your server

  If your server was running, restart it so that it can find the assets properly.


## Developers

Steps to modify themes directly from files.

1. Publish the theme which need to be updated/modified.

2. Update the theme assets, stylesheets, scripts and templates from the path. 
  ```
  public/vinsol_spree_themes/<theme_name>/
  ```

  or

  ```
  public/vinsol_spree_themes/current/
  ```

3. If application is running, reload the store page and you will see the changes on the browser.

4. Once all the changes are done and final theme is ready, run the following rake task to sync the updated files with the database.
  ```
  bundle exec rake db:sync_templates THEME_NAME=<theme_name>
  ```

*Note:- If the theme name is changed, then manually upload the theme from the admin panel as it will be considered a new theme.*


## Production Setup

1. Set the following configuration for production environment in environment production.rb file:
  ```ruby
  config.assets.compile = true
  config.public_file_server.enabled = true
  ```

2. Add the following path to the shared linked dir in deploy.rb file.
  ```
  set :linked_dirs, %w( public/vinsol_spree_themes )
  ```

## Usage

Once install, admin can see the option to upload themes under configuration tab at backend. Admin needs to upload the theme zip file in specific file structure. Once uploaded, admin can compile and publish the theme. Only after publishing, the theme will be applied to the frontend store.

By default, spree default frontend theme is pbulished and viewed on frontend.

File structure for the zip file to be uploaded:-
* Theme.zip
  * javascripts
  * stylesheets
  * views: These views will be the spree frontend view directory.
  * snapshot.png: This is the snapshot for the theme visible at backend.
  * meta_info.yml: This .yml file contains meta info of the theme.

Create a meta_info.yml file on the theme directory which contains the meta info of the theme. Format of the file should be following:-
 * name: Name of the theme
 * version: Version of the theme
 * authors: Authors of the theme


*Note:- Add new javascript files to javascripts directory and new stylesheet files to stylesheets directory. For adding js and css manifest files, file name should be script.manifest.js or style.manifest.js*

*Note:- When uploading, files starting with '__' or '.' will be ignored*


## Testing

First bundle your dependencies, then run `rake`. `rake` will default to building the dummy app if it does not exist, then it will run specs. The dummy app can be regenerated by using `rake test_app`.

```shell
bundle
bundle exec rake
```

When testing your applications integration with this extension you may use it's factories.
Simply add this require statement to your spec_helper:

```ruby
require 'vinsol_spree_themes/factories'
```


## Contributing

If you'd like to contribute, please take a look at the
[instructions](CONTRIBUTING.md) for installing dependencies and crafting a good
pull request.

Copyright (c) 2017 [name of extension creator], released under the New BSD License
